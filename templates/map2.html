<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Two Pages Side by Side</title>
    <!-- Swiper CSS -->
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />

  <!-- Swiper JS -->
  <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBqYx-DeSlI3zFJhrCav7sT5EMfKvgv5FI&libraries=places"></script>
    <script src="https://cdn.auth0.com/js/auth0-spa-js/2.0/auth0-spa-js.production.js"></script>
    <script src="map2.js"></script>
    <style>
      body {
        margin: 0;
        padding: 0;
        background-color: #e0f5f0;
        font-family: Poppins, sans-serif;
      }
      /* Define two columns */
      .column1 {
        float: left;
        width: 50%; /* Adjust this width to your preference */
        padding: 10px;
        box-sizing: border-box;
        overflow: hidden;
        /* background-color: aqua; */
      }

      .column2 {
        position: fixed;
        float: left;
        width: 50%; /* Adjust this width to your preference */
        padding: 10px;
        box-sizing: border-box;
        left: 50%;
        /* background-color: aquamarine; */
      }

      /* Clear floats after the columns */
      .row:after {
        content: "";
        display: table;
        clear: both;
      }
    </style>
  </head>
  <body>
    <div class="row">
      <div class="column1">
        <!-- Image -->
        <div style="position: relative; bottom: 10px">
          <img
            src="{{ city_pic_filename }}"
            alt="Naples"
            style="
              width: 52vw;
              height: 40vh;
              object-fit: cover;
              position: relative;
              right: 2vw;
            "
          />
          <div
            style="
              position: absolute;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background-color: rgba(0, 0, 0, 0);
            "
          ></div>
          <div
            style="
              position: absolute;
              top: 50%;
              left: 50%;
              transform: translate(-50%, -50%);
              color: #ffffff;
              text-align: center;
            "
          >
          <style>
            h1 {
              font-size: 2.7vw;
              font-weight: bold;
              margin-bottom: 1vh;
              position: absolute;
              right: 18vw;
              top: 1vh;
            }

          </style>
            <h1>
              {{ city }}
            </h1>
            <div
              style="
                background-color: #ffffff43;
                color: #fff;
                border-radius: 1vw;

                padding: 1vh 1vw;
                display: inline-block;
                position: relative;
                top: 15vh;
                right: 16vw;
              "
            >
              <span style="font-size: 1vw">{{ start_date }}</span>
              <span style="font-size: 1vw; margin: 0 0.5vw">-</span>
              <span style="font-size: 1vw">{{ end_date }}</span>
            </div>
          </div>
          <div style="position: absolute; top: 20px; left: 20px">
            <a
              href="./map.html"
              style="
                color: #fff;
                background-color: rgba(0, 0, 0, 0.5);
                border: none;
                border-radius: 10vw;
                padding: 0.5vh 0.5vw;
                cursor: pointer;
              "
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 14"
                stroke="currentColor"
                style="width: 1.5rem; height: 1.5rem"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 19l-7-7 7-7"
                />
              </svg>
            </a>
          </div>

          <div style="position: absolute; top: 2vh; right: 2vw">
            <style>
              /* Custom styles for the blur background */
              .popup-background {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(
                  0,
                  0,
                  0,
                  0.5
                ); /* Semi-transparent black background */
                z-index: 998; /* Ensure it appears behind the popup */
                backdrop-filter: blur(
                  4px
                ); /* Apply blur effect to the background */
              }

              /* Custom styles for the popup */
              #popup {
                display: none;
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: rgba(
                  255,
                  255,
                  255,
                  0.9
                ); /* Semi-transparent white background */
                padding: 2rem; /* Increased padding for better visual */
                border-radius: 12px; /* Rounded corners */
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.3); /* Increased box shadow for depth */
                z-index: 999; /* Ensure it appears above other content */
                text-align: center; /* Center align text */
              }

              /* Custom styles for the button */
              .custom-button {
                background-color: #4caf50; /* Green background */
                color: white; /* White text */
                padding: 10px 20px; /* Padding for button */
                border: none; /* No border */
                border-radius: 6px; /* Rounded corners */
                cursor: pointer; /* Cursor style */
                transition: background-color 0.3s; /* Smooth transition on hover */
              }

              /* Hover effect for the button */
              .custom-button:hover {
                background-color: #45a049; /* Darker green on hover */
              }

              /* Custom styles for the paragraph */
              .popup-text {
                margin-top: 1rem; /* Add some space between heading and paragraph */
                line-height: 1.5; /* Increase line height for readability */
              }
            </style>

            <div class="popup-background" id="popupBackground"></div>

            <div id="popup">
              <div class="max-w-sm mx-auto bg-white rounded-lg shadow-md p-6">
                <h2 class="text-lg font-semibold">
                  This Itiernery is yours to customize
                </h2>
                <p class="popup-text">
                  Sign in to make edits,<br />
                  add notes, and access your trip anytime from any device. ðŸŽ‰
                </p>
                <button class="mt-4 custom-button inline-flex items-center">
                  <svg
                    class="w-6 h-6 mr-2"
                    fill="currentColor"
                    viewBox="0 0 24 24"
                    style="position: relative; top: 2px"
                  >
                    <image href="/static/images/newtimg/imagess.png" width="24" height="24" />
                  </svg>
                  <span style="position: relative; bottom: 5px"
                    >Claim my trip</span
                  >
                </button>
              </div>
            </div>

            <button
              id="shareButton"
              style="
                position: absolute;
                top: 0px;
                right: 0px;
                color: #fff;
                background-color: rgba(0, 0, 0, 0.5);
                border: none;
                border-radius: 999px;
                padding: 0.5rem;
                cursor: pointer;
              "
            >




            <div>
              <svg xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink"
                   aria-hidden="true"
                   role="img"
                   class="text-base iconify iconify--ph"
                   width="6em"
                   height="1em"
                   viewBox="0 0 256 256"
                   style="position: relative; top: 8px; right: 20px;"
                  >
                  <path fill="currentColor"
                        d="m237.66 117.66l-80 80A8 8 0 0 1 144 192v-39.77c-57.1 3.24-96.25 40.27-107.24 52a12 12 0 0 1-20.68-9.58c3.71-32.26 21.38-63.29 49.76-87.37c23.57-20 52.22-32.69 78.16-34.91V32a8 8 0 0 1 13.66-5.66l80 80a8 8 0 0 1 0 11.32">
                  </path>
              </svg>
              <span style="position: relative; bottom: 9px; left: 9px;">Share</span>
          </div>



            </button>

            <script>
              const shareButton = document.getElementById("shareButton");
              const popup = document.getElementById("popup");
              const popupBackground =
                document.getElementById("popupBackground");

              // Function to close the popup
              const closePopup = () => {
                popup.style.display = "none";
                popupBackground.style.display = "none";
              };

              // Function to open the popup
              const openPopup = () => {
                popup.style.display = "block";
                popupBackground.style.display = "block";
              };

              // Event listener for the share button
              shareButton.addEventListener("click", (event) => {
                // Toggle the display of the popup
                if (
                  popup.style.display === "none" ||
                  popup.style.display === ""
                ) {
                  openPopup();
                } else {
                  closePopup();
                }

                // Prevent the click event from propagating further
                event.stopPropagation();
              });

              // Event listener to close the popup when clicking outside of it
              document.body.addEventListener("click", (event) => {
                // Check if the clicked element is not within the popup
                if (
                  !popup.contains(event.target) &&
                  popup.style.display === "block"
                ) {
                  closePopup();
                }
              });
            </script>
          </div>
        </div>

        <!-- Buttons -->
        <!-- Explore sights -->
        <div>
          <style>
            .custom-button {
              padding: 8px 16px;
              border-radius: 10px;
              border: 1px solid #cccccc;
              color: #333333;
              font-size: 14px;
              background-color: #ffffff;
              cursor: pointer;
              margin-right: 10px;
              transition: background-color 0.3s ease;
            }

            .custom-button a {
              text-decoration: none;
            }

            .custom-button:hover,
            .custom-button:focus {
              background-color: #f0f0f0;
              border-color: #056dff;
            }

            .custom-button:active {
              background-color: #e0e0e0;
            }
          </style>

          <div
            style="
              display: inline;
              position: relative;
              left: 6rem;
              bottom: -5px;
            "
          >

          <button class="custom-button" style="background-color: #f0f0f0; border: 0.2vw solid #ff0505" selected>
            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="child-reaching" class="svg-inline--fa fa-child-reaching mb-0.5 text-base transition-all text-gray-900" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="25" height="15">
              <path fill="currentColor" d="M512 96c0 50.2-59.1 125.1-84.6 155c-3.8 4.4-9.4 6.1-14.5 5H320c-17.7 0-32 14.3-32 32s14.3 32 32 32h96c53 0 96 43 96 96s-43 96-96 96H139.6c8.7-9.9 19.3-22.6 30-36.8c6.3-8.4 12.8-17.6 19-27.2H416c17.7 0 32-14.3 32-32s-14.3-32-32-32h-96c-53 0-96-43-96-96s43-96 96-96h39.8c-21-31.5-39.8-67.7-39.8-96c0-53 43-96 96-96s96 43 96 96M117.1 489.1c-3.8 4.3-7.2 8.1-10.1 11.3l-1.8 2l-.2-.2c-6 4.6-14.6 4-20-1.8C59.8 473 0 402.5 0 352c0-53 43-96 96-96s96 43 96 96c0 30-21.1 67-43.5 97.9c-10.7 14.7-21.7 28-30.8 38.5zM128 352a32 32 0 1 0-64 0a32 32 0 1 0 64 0m288-224a32 32 0 1 0 0-64a32 32 0 1 0 0 64"></path></svg>
              Itiernery</button>

            <button id="toggleButton" class="custom-button" style="background-color: #d5c7f5; border-color: #7e12e5; border: 0.2vw solid #7e12e5;">
              <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="child-reaching" class="svg-inline--fa fa-child-reaching mb-0.5 text-base transition-all text-gray-900" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="25" height="15">
                  <path fill="currentColor" d="M0 32C0 14.3 14.3 0 32 0H480c17.7 0 32 14.3 32 32s-14.3 32-32 32V448c17.7 0 32 14.3 32 32s-14.3 32-32 32H304V464c0-26.5-21.5-48-48-48s-48 21.5-48 48v48H32c-17.7 0-32-14.3-32-32s14.3-32 32-32V64C14.3 64 0 49.7 0 32zm96 80v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V112c0-8.8-7.2-16-16-16H112c-8.8 0-16 7.2-16 16zM240 96c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V112c0-8.8-7.2-16-16-16H240zm112 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V112c0-8.8-7.2-16-16-16H368c-8.8 0-16 7.2-16 16zM112 192c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V208c0-8.8-7.2-16-16-16H112zm112 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V208c0-8.8-7.2-16-16-16H240c-8.8 0-16 7.2-16 16zm144-16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16V208c0-8.8-7.2-16-16-16H368zM328 384c13.3 0 24.3-10.9 21-23.8c-10.6-41.5-48.2-72.2-93-72.2s-82.5 30.7-93 72.2c-3.3 12.8 7.8 23.8 21 23.8H328z"></path>
              </svg>
              Hotel Recommendation
          </button>
          <script>
              const toggleButton1 = document.getElementById('toggleButton');
              toggleButton.addEventListener('click', function() {
                  // Toggle background color
                  if (toggleButton.style.backgroundColor === 'rgb(213, 199, 245)') {
                      toggleButton.style.backgroundColor = '#ffffff';
                  } else {
                      toggleButton.style.backgroundColor = '#d5c7f5';
                  }
              });
          </script>

          <button id="toggleresturantButton1" class="custom-button" style="background-color: #a6f2b2; border: 0.2vw solid #24a237;">
            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="child-reaching" class="svg-inline--fa fa-child-reaching mb-0.5 text-base transition-all text-gray-900" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="25" height="15">
              <path fill="currentColor" d="M416 0C400 0 288 32 288 176V288c0 35.3 28.7 64 64 64h32V480c0 17.7 14.3 32 32 32s32-14.3 32-32V352 240 32c0-17.7-14.3-32-32-32zM64 16C64 7.8 57.9 1 49.7 .1S34.2 4.6 32.4 12.5L2.1 148.8C.7 155.1 0 161.5 0 167.9c0 45.9 35.1 83.6 80 87.7V480c0 17.7 14.3 32 32 32s32-14.3 32-32V255.6c44.9-4.1 80-41.8 80-87.7c0-6.4-.7-12.8-2.1-19.1L191.6 12.5c-1.8-8-9.3-13.3-17.4-12.4S160 7.8 160 16V150.2c0 5.4-4.4 9.8-9.8 9.8c-5.1 0-9.3-3.9-9.8-9L127.9 14.6C127.2 6.3 120.3 0 112 0s-15.2 6.3-15.9 14.6L83.7 151c-.5 5.1-4.7 9-9.8 9c-5.4 0-9.8-4.4-9.8-9.8V16zm48.3 152l-.3 0-.3 0 .3-.7 .3 .7z"></path>
            </svg>
            Restaurant Recommendation
          </button>

          <script>
            const button = document.getElementById('toggleresturantButton1');

            button.addEventListener('click', function() {
              // Toggle background color
              if (this.style.backgroundColor === 'rgb(166, 242, 178)') {
                this.style.backgroundColor = '#ffffff';
              } else {
                this.style.backgroundColor = '#a6f2b2';
              }
            });
          </script>



          <button class="custom-button" style="border: 0.2vw solid">
            <img alt="Get Your Guide" loading="lazy" width="9" height="9" decoding="async" data-nimg="1" class="mb-1.5 mr-1.5 inline-block"  src="/static/images/newtimg/gyg-icon.png" style="color: transparent;">
            <a href="https://www.getyourguide.com/">Get Your Guide</a>
          </button>
        </div>
      </div>



        <!-- Hotel Recommendation -->
        <div>
          <style>
            .wrapper {
    max-width: 100vw;
    width: 49vw;
    position: relative;
  }
  .wrapper i {
    top: 50%;
    height: 0px;
    width: 13px;
    cursor: pointer;
    font-size: 1.25rem;
    position: absolute;
    text-align: center;
    line-height: 40px;
    background: #ffffff;
    border-radius: 50%;
    box-shadow: 0 3px 6px rgba(0,0,0,0.23);
    transform: translateY(-50%);
    transition: transform 0.1s linear;
    display: flex;
    justify-content: space-between;
  }
  .wrapper i:active{
    transform: translateY(-50%) scale(0.85);
  }
  .wrapper i:first-child{
    left: -22px;
  }
  .wrapper i:last-child{
    right: 0.9vw;
  }
  .wrapper .carousel{
    display: grid;
    grid-auto-flow: column;
    grid-auto-columns: calc((48vw / 3) - 0.6vw);
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    gap: 1vw;
    border-radius: 0.5vw;
    scroll-behavior: smooth;
    scrollbar-width: none;
    margin-right: 1vw;
  }
  .carousel::-webkit-scrollbar {
    display: none;
  }
  .carousel.no-transition {
    scroll-behavior: auto;
  }
  .carousel.dragging {
    scroll-snap-type: none;
    scroll-behavior: auto;
  }
  .carousel.dragging .card {
    cursor: grab;
    user-select: none;
  }
  .carousel :where(.card, .img) {
    display: grid;
    justify-content: center;
    align-items: center;
  }
  .carousel .card {
    scroll-snap-align: start;
    height: 78vh;
    list-style: none;
    background: #fff;
    cursor: pointer;
    padding-bottom: 5vw;
    flex-direction: column;
    border-radius: 0.5vw;
  }
  .carousel .card .img {
    background: #8B53FF;
    height: 31.8vh;
    width: 15.vw;
    border-radius: 0.5vw;
  }

  .card .img img {
    width: 14.4vw;
    height: 30vh;
    border-radius: 5%;
    object-fit: cover;
    overflow: hidden;
transition: transform 0.3s ease;
}

.card .img img:hover {
  transform: scale(1.05);
}
  .carousel .card h2 {
    font-weight: 100;
    font-size: 1.6vw;
    margin: 1vw 1vw 1vw;
    position: relative;
    bottom: 0vw;
  }
  .carousel .card p {
    font-weight: 100;
    font-size: 0.9vw;
    margin: 1vw 1vw 1vw;
    position: relative;
    bottom: 1vw;
  }
  .carousel .card span {
    font-weight: 100;
    font-size: 0.9vw;
    margin: 1vw 1vw 1vw;
    position: relative;
    bottom: 2.1vw;
  }
  .carousel .card span2 {
    color: #000000;
    font-size: 0.9vw;
    position: relative;
    bottom: 2.5vw;
    left: 0px;
    padding: 1vw 1vw 1vw;
  }

  .wrapper {
              display: block;
              align-items: center;
              justify-content: center;
              margin-top: 2vw;
          }

          .arrow {
              cursor: pointer;
              font-size: 24px;
              margin: 0 10px;
          }

            </style>
          <div>

            <div class="wrapper">
              <div id="toggleButton" style="font-size: 1.5vw; color: #333; position: relative; left: 15vw; top: 0.5vw; text-decoration: underline; color: #b20000;">Hotel Recommendation</div>
              <i  id="left" class="fa-solid fa-angle-left"></i>
              <ul class="carousel">

              </ul>
              <i id="right" class="fa-solid fa-angle-right"></i>
            </div>
          </div>
          <script>


          document.addEventListener("DOMContentLoaded", function() {

      const carousel = document.querySelector(".carousel");

      // Fetch hotels data from JSON file
      fetch('{{ h_filename }}')
      .then(response => response.json())
          .then(data => {
              // Populate carousel with hotel cards
              data.forEach(hotel => {
                  const card = document.createElement("li");
                  card.className = "card";

                  const imageDiv = document.createElement("div");
                  imageDiv.className = "img";
                  const image = document.createElement("img");
                  image.src = hotel.image;
                  image.alt = hotel.name;
                  image.draggable = false;
                  imageDiv.appendChild(image);
                  card.appendChild(imageDiv);

                  const heading = document.createElement("h2");
                  heading.textContent = hotel.name;
                  card.appendChild(heading);

                  const address = document.createElement("p");
                  address.innerHTML = "<strong style='color: black;'>Address:</strong> " + hotel.address;
                  card.appendChild(address);

                  const span = document.createElement("span");
                  span.innerHTML = "<strong style='color: black;'>Experience:</strong> " +  hotel.experience;
                  card.appendChild(span);

                  const span2 = document.createElement("span2");
                  span2.innerHTML = "<strong style='color: black;'>Amenities:</strong> " +  hotel.amenities;
                  card.appendChild(span2);

                  const ratingDiv = document.createElement("div");
ratingDiv.innerHTML = "<strong style='color: black; font-size:0.9vw; position: relative; left:1vw; bottom: 2.2vw;'>Rating:</strong>";

const ratingValueSpan = document.createElement("span");
ratingValueSpan.innerText = hotel.rating; // Assuming hotel.rating is a floating-point number
ratingValueSpan.style.color = "black";
ratingValueSpan.style.marginRight = "5px";
ratingDiv.appendChild(ratingValueSpan);

const starsContainer = document.createElement("div"); // Create a container for the stars
starsContainer.style.display = "inline-flex"; // Ensure stars are displayed horizontally

const maxStars = 5;

for (let i = 0; i < maxStars; i++) {
    const star = document.createElement("span");
    star.className = "fa-solid fa-star";
    star.style.color = i < Math.ceil(hotel.rating) ? '#FFD700' : '#ccc'; // Set star color based on rating
    star.style.fontSize = "1vw"; // Adjust the size of the stars
    star.style.marginRight = "-1vw";
    star.style.position = "relative";
    star.style.left = "-3vw";
    starsContainer.appendChild(star); // Append each star to the container
}

const leftBracket = document.createElement("span");
leftBracket.innerText = "("; // Left bracket
leftBracket.style.marginRight = "1vw"; // Adjust margin for positioning
leftBracket.style.position = "relative";
leftBracket.style.left = "-1vw";

const rightBracket = document.createElement("span");
rightBracket.innerText = ")"; // Right bracket
rightBracket.style.marginLeft = "1vw"; // Adjust margin for positioning
rightBracket.style.position = "relative";
rightBracket.style.right = "-11vw";
rightBracket.style.bottom = "4.39vw";

ratingDiv.appendChild(leftBracket);
ratingDiv.appendChild(starsContainer); // Append the stars container
ratingDiv.appendChild(rightBracket);

card.appendChild(ratingDiv);

                  carousel.appendChild(card);
              });
          })
          .catch(error => console.error('Error fetching hotels data:', error));

      const arrowBtns = document.querySelectorAll(".wrapper i"); // Select arrow buttons

      // Event listener for arrow buttons
      arrowBtns.forEach(btn => {
          btn.addEventListener("click", () => {
              const firstCardWidth = carousel.querySelector(".card").offsetWidth;
              carousel.scrollLeft += btn.id == "left" ? -firstCardWidth : firstCardWidth;
          });
      });

  });

  const toggleButton = document.getElementById("toggleButton");
      const wrapper = document.querySelector(".wrapper");

      // Add event listener to the toggle button
      toggleButton.addEventListener("click", () => {
          // Toggle the visibility of the carousel wrapper
          if (wrapper.style.display === "none") {
              wrapper.style.display = "block";
              autoPlay(); // Start autoplay when the carousel is displayed
          } else {
              wrapper.style.display = "none";
          }
      });
            // const wrapper = document.querySelector(".wrapper");
  // const carousel = document.querySelector(".carousel");
  const firstCardWidth = carousel.querySelector(".card").offsetWidth;
  const arrowBtns = document.querySelectorAll(".wrapper i");
  arrowBtns.forEach(btn => {
      btn.addEventListener("click", () => {
          carousel.scrollLeft += btn.id == "left" ? -firstCardWidth : firstCardWidth;
      });
  });
  const carouselChildrens = [...carousel.children];

  let isDragging = false, isAutoPlay = true, startX, startScrollLeft, timeoutId;

  // Get the number of cards that can fit in the carousel at once
  let cardPerView = Math.round(carousel.offsetWidth / firstCardWidth);

  // Insert copies of the last few cards to beginning of carousel for infinite scrolling
  carouselChildrens.slice(-cardPerView).reverse().forEach(card => {
      carousel.insertAdjacentHTML("afterbegin", card.outerHTML);
  });

  // Insert copies of the first few cards to end of carousel for infinite scrolling
  carouselChildrens.slice(0, cardPerView).forEach(card => {
      carousel.insertAdjacentHTML("beforeend", card.outerHTML);
  });

  // Scroll the carousel at appropriate postition to hide first few duplicate cards on Firefox
  carousel.classList.add("no-transition");
  carousel.scrollLeft = carousel.offsetWidth;
  carousel.classList.remove("no-transition");

  // Add event listeners for the arrow buttons to scroll the carousel left and right
  arrowBtns.forEach(btn => {
      btn.addEventListener("click", () => {
          carousel.scrollLeft += btn.id == "left" ? -firstCardWidth : firstCardWidth;
      });
  });

  const dragStart = (e) => {
      isDragging = true;
      carousel.classList.add("dragging");
      // Records the initial cursor and scroll position of the carousel
      startX = e.pageX;
      startScrollLeft = carousel.scrollLeft;
  }

  const dragging = (e) => {
      if(!isDragging) return; // if isDragging is false return from here
      // Updates the scroll position of the carousel based on the cursor movement
      carousel.scrollLeft = startScrollLeft - (e.pageX - startX);
  }

  const dragStop = () => {
      isDragging = false;
      carousel.classList.remove("dragging");
  }

  const infiniteScroll = () => {
      // If the carousel is at the beginning, scroll to the end
      if(carousel.scrollLeft === 0) {
          carousel.classList.add("no-transition");
          carousel.scrollLeft = carousel.scrollWidth - (2 * carousel.offsetWidth);
          carousel.classList.remove("no-transition");
      }
      // If the carousel is at the end, scroll to the beginning
      else if(Math.ceil(carousel.scrollLeft) === carousel.scrollWidth - carousel.offsetWidth) {
          carousel.classList.add("no-transition");
          carousel.scrollLeft = carousel.offsetWidth;
          carousel.classList.remove("no-transition");
      }

      // Clear existing timeout & start autoplay if mouse is not hovering over carousel
      clearTimeout(timeoutId);
      if(!wrapper.matches(":hover")) autoPlay();
  }

  const autoPlay = () => {
      if(window.innerWidth < 800 || !isAutoPlay) return; // Return if window is smaller than 800 or isAutoPlay is false
      // Autoplay the carousel after every 2500 ms
      timeoutId = setTimeout(() => carousel.scrollLeft += firstCardWidth, 2500);
  }
  autoPlay();

  carousel.addEventListener("mousedown", dragStart);
  carousel.addEventListener("mousemove", dragging);
  document.addEventListener("mouseup", dragStop);
  carousel.addEventListener("scroll", infiniteScroll);
  wrapper.addEventListener("mouseenter", () => clearTimeout(timeoutId));
  wrapper.addEventListener("mouseleave", autoPlay);


            </script>
        </div>

<br><br>
          <!-- Resturant Recommendation -->
<div>
  <div id="restaurant-data" style="display: none; position: relative; bottom: 30px;">
    <div style="font-size: 1.5vw; color: #333; position: relative; left: 13vw; top: 0.5vw; text-decoration: underline; color: #b20000;">Resturant Recommendation</div>
    <style>
      #restaurant-data {
    display: none;
}
      .slide-container{
max-width: 100vw;
width: 48VW;
padding: 2vw 0;
}
.slide-content{
margin: 0 2vw;
overflow: hidden;
border-radius: 0vw;
}
.card{
border-radius: 1vw;
background-color: #FFF;
}
.image-content,
.card-content{
display: flex;
flex-direction: column;
align-items: center;
padding: 1vw 1vw;
height: 35vh;
}
.image-content{
position: relative;
row-gap: 0vw;
padding: 1.4vw 0;
}
.overlay{
position: absolute;
left: 0;
top: 0;
height: 32vh;
width: 14vw;
background-color: #4070F4;
border-radius: 1vw 1vw 1vw 1vw;
}

.card-image{
position: relative;
height: 29vh;
width: 12.2vw;
border-radius: 1vw;
background: #FFF;
padding: 0vw;
bottom: 0.9vw;
overflow: hidden;
transition: transform 0.3s ease;
}

.card-image:hover {
  transform: scale(1.05);
}

.card-image .card-img{
height: 28.4vh;
width: 12vw;
object-fit: cover;
border-radius: 0.4vw;
border: 0.2vw solid #4070F4;
}
.name{
font-size: 1.5vw;
font-weight: 500;
color: #000000;
text-align: center;
position: relative;
bottom: 5.5vw;
}
.description1{
font-size: 0.8vw;
color: #000000;
text-align: center;
position: relative;
bottom: 6vw;
right: 0vw;
width: 12vw;
padding: 0 21vw 0;
}
.open{
  font-size: 0.8vw;
font-weight: 500;
color: #000000;
text-align: center;
position: relative;
bottom: 7vw;
width: 11vw;
padding: 0 5vw 0 ;
}
.ratings{
font-size: 0.8vw;
font-weight: 500;
color: #000000;
text-align: center;
position: absolute;
top: 38vw;
left: 2vw;
}
.button{
border: none;
font-size: 16px;
color: #FFF;
padding: 8px 16px;
background-color: #4070F4;
border-radius: 6px;
margin: 14px;
cursor: pointer;
transition: all 0.3s ease;
}
.button:hover{
background: #265DF2;
}

.swiper-navBtn{
color: #6E93f7;
transition: color 0.3s ease;
}
.swiper-navBtn:hover{
color: #4070F4;
}
.swiper-navBtn::before,
.swiper-navBtn::after{
font-size: 35px;
}
.swiper-button-next{
right: 0;
}
.swiper-button-prev{
left: 0;
}
.swiper-pagination-bullet{
background-color: #6E93f7;
opacity: 1;
}
.swiper-pagination-bullet-active{
background-color: #4070F4;
}

@media screen and (max-width: 768px) {
.slide-content{
margin: 0 10px;
}
.swiper-navBtn{
display: none;
}
}
.card-content {
    padding: 1.5vw; /* Padding around the content */
    height: 45vh;
}

.card-content .label {
    font-weight: bold; /* Makes label text bold */
    margin-right: 5px; /* Space after the label */
}

.card-content p {
    margin-bottom: 8px; /* Space between paragraphs */
}
      </style>
    <div class="slide-container swiper">
      <div class="slide-content">
          <div class="card-wrapper swiper-wrapper" id="restaurant-cards">


          </div>
      </div>

      <div class="swiper-button-next swiper-navBtn"></div>
      <div class="swiper-button-prev swiper-navBtn"></div>
      <div class="swiper-pagination"></div>
  </div>
  <script>
    var swiper = new Swiper(".slide-content", {
        slidesPerView: 3,
        spaceBetween: 20,
        loop: false,
        centerSlide: true,
        fade: true,
        grabCursor: true,
        pagination: {
            el: ".swiper-pagination",
            clickable: true,
            dynamicBullets: true,
        },
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },

        breakpoints:{
            0: {
                slidesPerView: 1,
            },
            520: {
                slidesPerView: 2,
            },
            950: {
                slidesPerView: 3,
            },
        }
    });
    //
var togglerButton = document.getElementById("toggleresturantButton1");
    var restaurantData = document.getElementById("restaurant-data");

    togglerButton.addEventListener("click", function() {
        if (restaurantData.style.display === "none") {
            restaurantData.style.display = "block";
        } else {
            restaurantData.style.display = "none";
        }
    });

    var restaurantData = document.getElementById("restaurant-data");

// Function to fetch and populate restaurant data
function fetchAndPopulateRestaurantData() {
    fetch('{{ r_filename }}')
        .then(response => response.json())
        .then(data => {
            populateRestaurantCards(data);
            // Make sure restaurant data is visible
            restaurantData.style.display = "block";
        })
        .catch(error => console.error('Error fetching restaurant data:', error));
}

// Function to create restaurant cards
function createRestaurantCard(restaurant) {
    return `
    <div class="card swiper-slide">
        <div class="image-content">
            <span class="overlay"></span>
            <div class="card-image">
                <img src="${restaurant.image}" alt="Restaurant Image" class="card-img">
            </div>
        </div>
        <div class="card-content">
            <h2 class="name"><strong></strong> ${restaurant.name}</h2>
            <p class="description1"><strong style="right: 8px; position: relative">ADDRESS:</strong> ${restaurant.address}</p>
            <p class="open" ><strong style="right:4px; position:relative;">OPEN-HRS:</strong> ${restaurant.open_hours}</p>
            <p class="ratings"><strong style="right: 3px; position: relative">RATING:</strong> ${restaurant.avg_stars} (

                ${generateStars(restaurant.avg_stars)}
            )</p>
        </div>
    </div>
    `;
}
function generateStars(avgStars, starColor) {
    let stars = '';
    let remainder = avgStars - Math.floor(avgStars); // Get the fractional part

    for (let i = 1; i <= 5; i++) {
        if (i <= Math.floor(avgStars)) {
            stars += `<span class="fa-solid fa-star checked" style="color: #FFD700;"></span>`;
        } else if (i === Math.floor(avgStars) + 1 && remainder > 0) {
            // Fractional star
            stars += `<span class="fa-solid fa-star checked" style="color: #FFD700; opacity: ${remainder};"></span>`;
        } else {
            stars += '<span class="fa-solid fa-star" style="color: #ece0e0;"></span>';
        }
    }
    return stars;
}


// Function to populate restaurant cards
function populateRestaurantCards(data) {
    var restaurantCards = "";
    data.forEach(function(restaurant) {
        restaurantCards += createRestaurantCard(restaurant);
    });
    document.getElementById("restaurant-cards").innerHTML = restaurantCards;
}

// Call the function to fetch and populate restaurant data when the page loads
fetchAndPopulateRestaurantData();

</script>

  </div>
</div>



        <!-- Regenerate Itiernery -->
        <div>
          <div style="font-size: 1.5rem; color: #333; position: relative; left: 25rem; top: 5px; text-decoration: underline; color: #b20000;">Itiernery</div>
          <div
            style="
              background-color: #e0f5f0;
              padding: 1rem;
              font-family: Poppins,sans-serif;
            "
          >
          <div style="margin-bottom: 1rem; border: 1px ;">



        <div>
          <style>
              .accordion > input[type="checkbox"] {
                  position: absolute;
                  left: -100vw;
              }
              .accordion .content {
                  overflow-y: hidden;
                  height: 0;
                  transition: height 0.3s ease;
              }
              .accordion > input[type="checkbox"]:checked ~ .content {
                  height: auto;
                  overflow: visible;
              }
              .accordion label {
                  display: block;
              }
              .accordion {
                  margin-bottom: 1em;
              }
              .accordion > input[type="checkbox"]:checked ~ .content {
                  padding: 15px;
                  border: 1px solid #e8e8e8;
                  border-top: 0;
                  height: 95rem;
              }
              .accordion .handle {
                  margin: 0;
                  font-size: 1.125em;
                  line-height: 1.2em;
              }
              .accordion label {
                  color: #333;
                  cursor: pointer;
                  font-weight: normal;
                  padding: 15px;
                  background: #e8e8e8;
                  border-radius: 10px;
              }
              .accordion label:hover,
              .accordion label:focus {
                  background: #d8d8d8;
              }
              .accordion .handle label:before {
                  font-family: 'fontawesome';
                  content: "\f054";
                  display: inline-block;
                  margin-right: 25px;
                  font-size: .58em;
                  line-height: 1.556em;
                  vertical-align: middle;
              }
              .accordion > input[type="checkbox"]:checked ~ .handle label:before {
                  content: "\f078";
              }
          </style>
          <section id="accordionContainer" class="accordion"></section>
          <script>
              async function loadData() {
      try {
          // Fetch restaurant data first
          {#const resResponse = await fetch('/static/resturant.json');#}
          {#const restaurantData = await resResponse.json();#}

          // Then fetch attractions data
          const attrResponse = await fetch('{{ filename }}');
          const attractionData = await attrResponse.json();


          // Process each date with the restaurant data available
          attractionData.date_list.forEach((date, index) => {
              const section = document.createElement('section');
              section.classList.add('accordion');
              const input = document.createElement('input');
              input.setAttribute('type', 'checkbox');
              input.setAttribute('id', 'handle' + (index + 1));
              section.appendChild(input);

              const h2 = document.createElement('h2');
              h2.classList.add('handle');
              const label = document.createElement('label');
              label.setAttribute('for', 'handle' + (index + 1));
              label.textContent = new Date(date).toLocaleDateString('en-US', {
                  weekday: 'long',
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric'
              });
              h2.appendChild(label);
              section.appendChild(h2);
              // Retrieve restaurant entries for the current date
              {#const restaurantEntries = restaurantData[date] || [];  // Use empty array if no data for the date#}



              // Find matching tour data for the current date
              const tourData = attractionData.attractions_data.filter(item => item.date === date);


              tourData.forEach((tour, idx) => {
                  const container = document.createElement('div');
                  container.classList.add('container');
                  container.style.maxWidth = '43rem';
                  container.style.height = '10rem';
                  container.style.backgroundColor = '#f3f9f7';
                  container.style.padding = '1rem';
                  container.style.borderRadius = '0.5rem';
                  container.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.1)';
                  container.style.marginBottom = '2rem';
                  container.style.position = 'relative';
                  container.style.top = '1rem';
                  container.style.display = 'none';  // Initially hide the container

                  const title = document.createElement('h2');
                  title.textContent = tour.name;
                  title.style.fontSize = '1.125rem';
                  title.style.fontWeight = '600';
                  title.style.position = 'relative';
                  title.style.bottom = '15px';
                  title.style.wordWrap = 'break-word';
                  container.appendChild(title);

                  const description = document.createElement('p');
                description.classList.add('description');
                description.innerHTML = `<b>Category:</b> ${tour.category}`;
                description.style.color = '#333';
                description.style.position = 'relative';
                description.style.right = '0px';
                description.style.fontSize = '16px';
                container.appendChild(description);

                const details = document.createElement('div');
                details.classList.add('details');
                details.style.display = 'flex';
                details.style.alignItems = 'center';
                details.style.justifyContent = 'space-between';
                details.style.fontSize = '0.875rem';
                details.style.color = '#666';
                details.style.marginTop = '0.5rem';
                container.appendChild(details);


                // Creating and appending the rating element
                // Creating and appending the rating element
                const rating = document.createElement('span');
                rating.classList.add('time');
                rating.innerHTML = `<b>Rating:</b> ${tour.rating} (`;
                const ratingValue = tour.rating;
                const maxStars = 5; // Maximum number of stars

                 // Loop to create stars and set their color based on rating
                for (let i = 0; i < maxStars; i++) {
                    const star = document.createElement('span');
                    star.classList.add('fa', 'fa-star'); // Use 'fa' and not 'fa-solid' for compatibility with FontAwesome 4.x

                    if (i < Math.floor(ratingValue)) {
                        star.classList.add('checked'); // Full star
                        star.style.color = '#FFD700'; // Gold color for filled stars
                    } else if (i < Math.ceil(ratingValue) && ratingValue % 1 !== 0) {
                        star.classList.remove('fa-star');
                        star.classList.add('fa-star-half-alt'); // Half star
                        star.style.color = '#FFD700'; // Gold color for half-filled star
                    } else {
                        star.style.color = '#ccc'; // Grey color for unfilled stars
                    }
                    rating.appendChild(star);
                }
                rating.innerHTML += ')'; // Added closing parenthesis
                details.appendChild(rating);


                const separator = document.createElement('span');
                separator.classList.add('separator');
                separator.style.margin = '0 0.25rem';
                details.appendChild(separator);

                const cost = document.createElement('span');
                cost.classList.add('cost');
                cost.textContent = `Price: ${tour.price}`;
                cost.style.color = '#000000';
                details.appendChild(cost);

                 // Check if line should be added based on a condition (e.g., tour.category)
                 if (idx !== tourData.length - 1) {
    const line = document.createElement('div');
    line.classList.add('line');
    line.style.borderLeft = '2px solid #ccc';
    line.style.height = '20%';
    line.style.position = 'absolute';
    line.style.top = '192px';
    line.style.left = '33px';
    container.appendChild(line);
}




    const image = document.createElement('img');
    image.src = tour.image; // Assuming 'imageSrc' is the key for the image URL in your JSON
    image.style.width = '170px';
    image.style.position = 'absolute';
    image.style.top = '1rem';
    image.style.left = '46rem';
    image.style.height = '10rem';
    image.style.borderRadius = '15px';
    container.appendChild(image);

                section.appendChild(container);


                  // Append restaurant info if available
                  {#restaurantEntries.forEach(restaurant => {#}
                  {#    const restInfo = document.createElement('p');#}
                  {#    restInfo.textContent = "Restaurant Name: " + restaurant.name + ", Specialties: " + restaurant.categories;#}
                  {#    container.appendChild(restInfo);});#}


                  {#section.appendChild(container);#}
              });

              input.addEventListener('change', function() {
                  const containers = this.parentElement.querySelectorAll('.container');
                  containers.forEach(container => {
                      container.style.display = this.checked ? 'block' : 'none';
                  });
              });

              document.getElementById('accordionContainer').appendChild(section);
          });
      } catch (error) {
          console.error('Error fetching JSON:', error);
      }
  }

              loadData();
          </script>
  </div>
        </div>

      </div>
</div>
</div>

      <!-- Right side half -->
      <div class="column2">
        <body onload="initMap()">
          <h1 class="text-center"></h1>

          <div class="container">
            <div
              id="map"
              // style="height: 1300px; width: 102%; left: -1%; top: -32px"
              style="height: 103vh; width: 50vw; left: -1%; top: -32px"
            ></div>
          </div>
          <!-- <button onclick="calcRoute()"></button> -->
          <div id="imageContainer">
            <img id="imageToShow" src="" alt="Image">
          </div>

            <script>
             let directionMapVisible = false;

function toggleDirection2() {
    if (directionMapVisible) {
        window.location.reload(); // Reload the page
    } else {
        showDirectionMap(); // Show direction map
        directionMapVisible = true;
    }
}

element.addEventListener('click', () => {
    // Show the image when name is clicked
    const imageToShow = document.getElementById('imageToShow');
    imageToShow.src = coord.image; // Use coord.image for the image source
    document.getElementById('imageContainer').style.display = 'block';
});


async function fetchCoordinates() {
    try {
        const response = await fetch('/static/direction.json'); // assuming coordinates.json is the name of your JSON file
        if (!response.ok) {
            throw new Error('Failed to fetch coordinates');
        }
        const data = await response.json();
        return data;
    } catch (error) {
        console.error(error);
        return [];
    }
}


async function showDirectionMap() {
    const coordinates = await fetchCoordinates();

    if (coordinates.length === 0) {
        console.error('No coordinates data available');
        return;
    }

    const map = new google.maps.Map(document.getElementById("map"), {
        zoom: 2,
        center: { lat: coordinates[0].lat, lng: coordinates[0].lng }, // Center the map on the first coordinate

    });

    const directionsService = new google.maps.DirectionsService();
    const directionsRenderer = new google.maps.DirectionsRenderer({
        map: map,
        suppressMarkers: true, // Suppress default markers
    });

    // Add click event listeners to each name
    coordinates.forEach(coord => {
        const element = document.createElement('span');
        element.textContent = coord.name;
        element.style.cursor = 'pointer';
        element.addEventListener('click', () => {
            // Show the image when name is clicked
            const imageToShow = document.getElementById('imageToShow');
            imageToShow.src = coord.image;
            document.getElementById('imageContainer').style.display = 'block';
        });
        document.body.appendChild(element);
    });

    // Close the image when clicked outside
    document.getElementById('imageContainer').addEventListener('click', (event) => {
        if (event.target === document.getElementById('imageContainer')) {
            document.getElementById('imageContainer').style.display = 'none';
        }
    });

    // Set up waypoints
    const waypoints = coordinates.slice(1, coordinates.length - 1).map(coord => ({
        location: new google.maps.LatLng(coord.lat, coord.lng),
        stopover: true
    }));

    const origin = new google.maps.LatLng(coordinates[0].lat, coordinates[0].lng);
    const destination = new google.maps.LatLng(coordinates[coordinates.length - 1].lat, coordinates[coordinates.length - 1].lng);

    // Request directions
    directionsService.route({
        origin: origin,
        destination: destination,
        waypoints: waypoints,
        travelMode: google.maps.TravelMode.DRIVING,
    }, function(response, status) {
        if (status === 'OK') {
            directionsRenderer.setDirections(response);
        } else {
            window.alert('Directions request failed due to ' + status);
        }
    });

    // Add markers with labels
    coordinates.forEach(coord => {
        const marker = new google.maps.Marker({
            position: { lat: coord.lat, lng: coord.lng },
            map: map,
            label: coord.name,
            icon: {
                 // Green marker icon
            },
        });
    });
}

showDirectionMap();


function initMap() {
              const map = new google.maps.Map(document.getElementById("map"), {
                zoom: 9,
                center: { lat: 43.1024360657, lng: -78.9616394043 }, // Center the map on one of the coordinates
              });

              // Fetch JSON data
    fetch('{{ filename }}')
        .then(response => response.json())
        .then(data => {

            if (data.centroid_lat && data.centroid_long) {
                const newCenter = { lat: data.centroid_lat, lng: data.centroid_long };
                map.setCenter(newCenter);
            }
            // Add markers with labels and info windows
           data.attractions_data.forEach(info => {
                createMarker(info, map);
            });
        })
        .catch(error => console.error('Error fetching data:', error));
}


            function createMarker(info, map) {
            const dayIndex = new Date(info.date).getDay();

            const clusterColors = [
        "#66aa00", "#109618", "#ff9900", "#316395", "#990099", // For days 1-5
        "#0099c6", "#dd4477", "#3366cc", "#b82e2e", "#dc3912"  // Extend this array as needed
    ];
             const iconColor = clusterColors[info.cluster % clusterColors.length];
              // Create the marker with custom SVG icon
const customMarker = new google.maps.Marker({
        position: { lat: info.lat, lng: info.long },
        map: map,
        icon: {
          url:
                    "data:image/svg+xml;charset=UTF-8," +
                    encodeURIComponent(
                      '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="' +
                        clusterColors[info.cluster] + // Use cluster color
                        '" width="48px" height="48px">' +
                        '<path d="M12 0c-4.4 0-8 3.6-8 8 0 7 8 16 8 16s8-9 8-16c0-4.4-3.6-8-8-8zm0 11.5c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3z"/>' +
                        // Text element for cluster number
                        '<text x="50%" y="75%" text-anchor="middle" alignment-baseline="middle" fill="white" font-size="12px">' +
                        info.cluster +
                        "</text>" +
                        "</svg>"
                    ),
                  scaledSize: new google.maps.Size(30, 30), // Set the size of the icon
                  origin: new google.maps.Point(0, 0), // Set the origin point
                  anchor: new google.maps.Point(12, 40), // Set the anchor point
                },
              });
               const infowindow = new google.maps.InfoWindow({
        content: `<div>
                    <h5>${info.name}</h5>
                    <p><strong>Time of day:</strong> ${info.timeofday}</p>
                    <p><strong>Price:</strong> $${info.price.toFixed(2)}</p>
                    <p><strong>Rating:</strong> ${info.rating} stars</p>
                    <img src="${info.image}" alt="${info.name}" style="width:100%; height:auto;">
                  </div>`
    });
    customMarker.addListener("click", function() {
        infowindow.open(map, customMarker);
    });
            }
          </script>

        </body>
      </div>
    </div>
  </body>
</html>
